#!/bin/bash

# ##################################################
# Print usage and manage opts
# ##################################################

if [ $# -eq 0 ]; then
  echo "Please provide an INSTANCE_NAME to unbind"
  exit 1
fi

instance_name=$1

# ##################################################
# Initialize script
# ##################################################

source base
trap "log_output \"[OWNER] ðŸš¦ Stopping guest.unbind script\"; exit 1" SIGINT

# ##################################################
# Purge guest VM
# ##################################################

log_output "[HOST] ðŸ’¤ Unbinding Guest machine: $instance_name"
tart stop "$instance_name"
tart delete "$instance_name"
log_output "[HOST] ðŸ’£ Guest machine: $instance_name successfully unbound!"
# TODO: publish to buildkansen deregister endpoint